<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
Â  <title>Trial of the Raelos</title>
Â  <style>
Â  Â  body {
Â  Â  Â  font-family: 'Segoe UI', sans-serif;
Â  Â  Â  margin: 0;
Â  Â  Â  padding: 0;
Â  Â  Â  background: #f4f4f4;
Â  Â  }
Â  Â  header {
Â  Â  Â  background: #222;
Â  Â  Â  color: white;
Â  Â  Â  padding: 1em;
Â  Â  Â  text-align: center;
Â  Â  }
Â  Â  nav {
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: space-around;
Â  Â  Â  background: #ddd;
Â  Â  }
Â  Â  nav button {
Â  Â  Â  flex: 1;
Â  Â  Â  padding: 1em;
Â  Â  Â  border: none;
Â  Â  Â  background: #ddd;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  nav button.active {
Â  Â  Â  background: #bbb;
Â  Â  Â  font-weight: bold;
Â  Â  }
Â  Â  .tab {
Â  Â  Â  display: none;
Â  Â  Â  padding: 1em;
Â  Â  }
Â  Â  .card {
Â  Â  Â  background: white;
Â  Â  Â  padding: 1em;
Â  Â  Â  margin: 1em 0;
Â  Â  Â  border-radius: 8px;
Â  Â  }
Â  Â  #loginScreen {
Â  Â  Â  padding: 2em;
Â  Â  Â  text-align: center;
Â  Â  }
Â  Â  input[type="text"] {
Â  Â  Â  padding: 0.5em;
Â  Â  Â  width: 200px;
Â  Â  Â  margin-bottom: 1em;
Â  Â  }
Â  Â  button {
Â  Â  Â  padding: 0.5em 1em;
Â  Â  }
Â  </style>
</head>
<body>
<div id="loginScreen">
Â  <h1>Trial of the Raelos</h1>
Â  <p>Enter your RaeloCode:</p>
Â  <input type="text" id="code" placeholder="e.g. moon-fox75" />
Â  <br/>
Â  <button onclick="login()">Log In</button>
</div>

<div id="main" style="display:none">
Â  <header>
Â  Â  <h2>Welcome, <span id="welcomeName"></span> of Team <span id="welcomeTeam"></span></h2>
Â  </header>
Â  <nav>
Â  Â  <button onclick="showTab('dashboard', this)" class="active">ğŸï¸ Dashboard</button>
Â  Â  <button onclick="showTab('team', this)">ğŸ§‘â€ğŸ¤â€ğŸ§‘ My Team</button>
Â  Â  <button onclick="showTab('leaderboard', this)">ğŸ“Š Leaderboard</button>
Â  Â  <button onclick="showTab('inventory', this)">ğŸ’ Inventory</button>
Â  Â  <button onclick="logout()">ğŸ”“ Log Out</button>
Â  </nav>

Â  <div id="dashboard" class="tab" style="display:block">
Â  Â  <h2>ğŸï¸ Dashboard</h2>
Â  Â  <div class="card">This is your main dashboard.</div>
Â  </div>
Â  <div id="team" class="tab">
Â  Â  <h2>ğŸ§‘â€ğŸ¤â€ğŸ§‘ My Team</h2>
Â  Â  <div class="card">Coming soon: Team members list</div>
Â  </div>
Â  <div id="leaderboard" class="tab">
Â  Â  <h2>ğŸ“Š Team Leaderboard</h2>
Â  Â  <div class="card" id="leaderboardList"></div>
Â  </div>
Â  <div id="inventory" class="tab">
Â  Â  <h2>ğŸ’ Inventory</h2>
Â  Â  <div class="card">
Â  Â  Â  <strong>Items:</strong>
Â  Â  Â  <div id="inventoryList"></div>
Â  Â  Â  <pre id="debugUser" style="margin-top:1em; background:#f9f9f9; padding:10px; border:1px dashed #ccc;"></pre>
Â  Â  </div>
Â  </div>
</div>

<script>
let currentUser = null;
let allRows = [];

const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRESlbp9XlNZx481_QpFCBIVceUeKgWL_YzeMIF1KO2RvOZUGx5c7bcYodxd3DepyHKhM1qPQRSfK8g/pub?output=tsv";

function showTab(tabId, el) {
Â  document.querySelectorAll(".tab").forEach(t => t.style.display = "none");
Â  document.querySelectorAll("nav button").forEach(b => b.classList.remove("active"));
Â  document.getElementById(tabId).style.display = "block";
Â  el.classList.add("active");

Â  if (tabId === "leaderboard") {
Â  Â  renderLeaderboard();
Â  }
Â  if (tabId === "inventory") {
Â  Â  // Add a small delay for the DOM to render the elements visible
Â  Â  setTimeout(() => {
Â  Â  Â  renderInventory();
Â  Â  }, 50); // 50 milliseconds should be enough, adjust if needed
Â  }
}

// ... rest of your script, including the renderInventory function you already have ...

async function login() {
Â  const code = document.getElementById("code").value.trim().toLowerCase();
Â  const res = await fetch(SHEET_URL);
Â  const text = await res.text();
Â  const rows = text.trim().split("\n").map(row => row.split("\t"));
Â  const userIndex = rows.findIndex(r => r[1].toLowerCase() === code);
Â  if (userIndex === -1) {
Â  Â  alert("RaeloCode not found.");
Â  Â  return;
Â  }
Â  const r = rows[userIndex];
Â  currentUser = {
Â  Â  name: r[0],
Â  Â  code: r[1],
Â  Â  team: r[2],
Â  Â  points: r[3],
Â  Â  items: r[4],
Â  Â  status: r[5]
Â  };
Â  allRows = rows.slice(1);
Â  document.getElementById("loginScreen").style.display = "none";
Â  document.getElementById("main").style.display = "block";
Â  document.getElementById("welcomeName").textContent = currentUser.name;
Â  document.getElementById("welcomeTeam").textContent = currentUser.team;
Â  showTab("dashboard", document.querySelector("nav button"));
}

function logout() {
Â  currentUser = null;
Â  document.getElementById("main").style.display = "none";
Â  document.getElementById("loginScreen").style.display = "block";
Â  document.getElementById("code").value = "";
}

function renderLeaderboard() {
Â  const scores = {};
Â  allRows.forEach(r => {
Â  Â  const team = r[2];
Â  Â  const points = parseInt(r[3]) || 0;
Â  Â  scores[team] = (scores[team] || 0) + points;
Â  });
Â  const leaderboard = Object.entries(scores)
Â  Â  .sort((a, b) => b[1] - a[1])
Â  Â  .map(([team, score], i) => `<li><strong>${i + 1}. ${team}</strong> â€“ ${score} points</li>`)
Â  Â  .join("");
Â  document.getElementById("leaderboardList").innerHTML = "<ul>" + leaderboard + "</ul>";
}

function renderInventory() {
Â  console.log("--- Starting renderInventory ---");
Â  const list = document.getElementById("inventoryList");
Â  const debug = document.getElementById("debugUser");

Â  console.log("Value of 'list' after getElementById:", list);
Â  console.log("Value of 'debug' after getElementById:", debug);

Â  if (!list) {
Â  Â  console.error("Error: inventoryList element not found!");
Â  Â  return;
Â  }
Â  if (!debug) {
Â  Â  console.error("Error: debugUser element not found!");
Â  Â  return;
Â  }

Â  if (!currentUser) {
Â  Â  console.error("currentUser is null in renderInventory.");
Â  Â  list.innerHTML = "<em>Error: User data not loaded.</em>";
Â  Â  debug.textContent = "Error: User data not loaded.";
Â  Â  return;
Â  }

Â  const items = currentUser.items || "";
Â  console.log("currentUser.items (raw from currentUser):", items);

Â  if (!items.trim()) {
Â  Â  console.log("Items are empty or whitespace. Displaying 'No items'.");
Â  Â  list.innerHTML = "<em>No items in inventory.</em>";
Â  } else {
Â  Â  console.log("Items found. Parsing and displaying.");
Â  Â  const itemList = items.split(",").map(item => item.trim());
Â  Â  list.innerHTML = "<ul>" + itemList.map(i => "<li>" + i + "</li>").join("") + "</ul>";
Â  }
Â  debug.textContent = JSON.stringify(currentUser, null, 2); // This is line 183 where the error occurs
Â  console.log("--- renderInventory complete ---");
}
</script>
</body>
</html>
